(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"137f":function(e,t,a){"use strict";var n=a("2cdd"),s=a.n(n);s.a},"181f":function(e,t,a){"use strict";var n=a("f0ae"),s=a.n(n);s.a},"2cdd":function(e,t,a){},"2ff9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"column flex justify-start items-center"},[a("profile-form",{staticClass:"q-mb-lg"}),a("q-btn-group",{attrs:{push:""}},[a("q-btn",{attrs:{push:"",color:"toolbar",label:"Digital ID"},on:{click:function(t){e.digitalId=!0}}}),a("q-btn",{attrs:{push:"",color:"primary",label:"Change Password"},on:{click:function(t){e.changePassword=!0}}}),a("q-btn",{attrs:{push:"",color:"accent",label:"Memberbucks"},on:{click:function(t){return e.$router.push({name:"memberbucks"})}}})],1),a("q-dialog",{model:{value:e.digitalId,callback:function(t){e.digitalId=t},expression:"digitalId"}},[a("digital-id-card")],1),a("q-dialog",{model:{value:e.changePassword,callback:function(t){e.changePassword=t},expression:"changePassword"}},[a("change-password-card")],1)],1)},s=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"profile-form"},[a("p",[e._v("\n    "+e._s(e.$t("form.pageDescription"))+"\n  ")]),a("q-form",{ref:"formRef"},[a("q-input",{attrs:{outlined:"",debounce:e.debounceLength,label:e.$t("form.email"),rules:[function(t){return e.validateEmail(t)||e.$t("validation.invalidEmail")}]},on:{input:function(t){return e.saveChange("email")}},scopedSlots:e._u([{key:"append",fn:function(){return[a("saved-notification",{attrs:{"show-text":"",error:e.saved.error},model:{value:e.saved.email,callback:function(t){e.$set(e.saved,"email",t)},expression:"saved.email"}})]},proxy:!0}]),model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}}),a("q-input",{attrs:{outlined:"",debounce:e.debounceLength,label:e.$t("form.firstName"),rules:[function(t){return e.validateNotEmpty(t)||e.$t("validation.cannotBeEmpty")}]},on:{input:function(t){return e.saveChange("firstName")}},scopedSlots:e._u([{key:"append",fn:function(){return[a("saved-notification",{attrs:{"show-text":"",error:e.saved.error},model:{value:e.saved.firstName,callback:function(t){e.$set(e.saved,"firstName",t)},expression:"saved.firstName"}})]},proxy:!0}]),model:{value:e.form.firstName,callback:function(t){e.$set(e.form,"firstName",t)},expression:"form.firstName"}}),a("q-input",{attrs:{outlined:"",debounce:e.debounceLength,label:e.$t("form.lastName"),rules:[function(t){return e.validateNotEmpty(t)||e.$t("validation.cannotBeEmpty")}]},on:{input:function(t){return e.saveChange("lastName")}},scopedSlots:e._u([{key:"append",fn:function(){return[a("saved-notification",{attrs:{"show-text":"",error:e.saved.error},model:{value:e.saved.lastName,callback:function(t){e.$set(e.saved,"lastName",t)},expression:"saved.lastName"}})]},proxy:!0}]),model:{value:e.form.lastName,callback:function(t){e.$set(e.form,"lastName",t)},expression:"form.lastName"}}),a("q-input",{attrs:{outlined:"",debounce:e.debounceLength,label:e.$t("form.phone"),rules:[function(t){return e.validateNotEmpty(t)||e.$t("validation.invalidPhone")}]},on:{input:function(t){return e.saveChange("phone")}},scopedSlots:e._u([{key:"append",fn:function(){return[a("saved-notification",{attrs:{"show-text":"",error:e.saved.error},model:{value:e.saved.phone,callback:function(t){e.$set(e.saved,"phone",t)},expression:"saved.phone"}})]},proxy:!0}]),model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}}),a("q-input",{attrs:{outlined:"",debounce:e.debounceLength,label:e.$t("form.screenName"),rules:[function(t){return e.validateNotEmpty(t)||e.$t("validation.cannotBeEmpty")}]},on:{input:function(t){return e.saveChange("screenName")}},scopedSlots:e._u([{key:"append",fn:function(){return[a("saved-notification",{attrs:{"show-text":"",error:e.saved.error},model:{value:e.saved.screenName,callback:function(t){e.$set(e.saved,"screenName",t)},expression:"saved.screenName"}})]},proxy:!0}]),model:{value:e.form.screenName,callback:function(t){e.$set(e.form,"screenName",t)},expression:"form.screenName"}}),a("q-select",{attrs:{outlined:"",label:e.$t("groups"),"use-input":"","use-chips":"",multiple:"",options:e.groups,"option-value":"id","option-label":"name",rules:[function(t){return e.validateNotEmpty(t)||e.$t("validation.cannotBeEmpty")}]},on:{input:function(t){return e.saveChange("groups")}},scopedSlots:e._u([{key:"append",fn:function(){return[a("saved-notification",{attrs:{"show-text":"",error:e.saved.error},model:{value:e.saved.groups,callback:function(t){e.$set(e.saved,"groups",t)},expression:"saved.groups"}})]},proxy:!0}]),model:{value:e.form.groups,callback:function(t){e.$set(e.form,"groups",t)},expression:"form.groups"}})],1)],1)},r=[],i=(a("8e6e"),a("8a81"),a("ac6a"),a("cadf"),a("06db"),a("456d"),a("c47a")),c=a.n(i),l=a("2f62"),u=a("985d"),d=a("9744"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],staticClass:"text-body1 text-center saved-message"},[e.showText?[e._v("\n      "+e._s(e.error?e.$t("form.error"):e.$t("form.saved"))+"\n    ")]:e._e(),a("q-icon",{attrs:{color:e.error?"fail":"success",name:e.error?e.icons.fail:e.icons.success}})],2)])},p=[],m=(a("c5f6"),{name:"SavedNotification",props:{value:{type:Boolean,default:!1},error:{type:Boolean,default:!1},timeout:{type:Number,default:2e3},showText:{type:Boolean,default:!1}},methods:{showNotification:function(){var e=this;setTimeout((function(){e.$emit("input",!1)}),this.timeout)}},watch:{value:function(e){e&&this.showNotification()}},computed:{icons:function(){return u["a"]}}}),v=m,b=(a("97b7"),a("2877")),h=a("eebe"),w=a.n(h),g=a("0016"),y=Object(b["a"])(v,f,p,!1,null,"d8669812",null),P=y.exports;function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){c()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}w()(y,"components",{QIcon:g["a"]});var N={name:"ProfileForm",mixins:[d["a"]],components:{SavedNotification:P},data:function(){return{form:{email:"",firstName:"",lastName:"",phone:"",screenName:"",groups:[]},saved:{error:!1,email:!1,firstName:!1,lastName:!1,phone:!1,screenName:!1,groups:!1}}},methods:C({},Object(l["b"])("profile",["getProfile"]),{loadInitialForm:function(){this.form.email=this.profile.email,this.form.firstName=this.profile.firstName,this.form.lastName=this.profile.lastName,this.form.phone=this.profile.phone,this.form.screenName=this.profile.screenName,this.form.groups=this.profile.groups},saveChange:function(e){var t=this;this.$refs.formRef.validate(!1).then((function(){t.$refs.formRef.validate(!1).then((function(a){a&&t.$axios.put("/api/profile/",t.form).then((function(){t.saved.error=!1,t.saved[e]=!0,t.getProfile()})).catch((function(){t.saved.error=!0,t.saved[e]=!0}))}))}))}}),beforeMount:function(){this.loadInitialForm()},watch:{profile:function(){this.loadInitialForm()}},computed:C({},Object(l["c"])("profile",["profile"]),{},Object(l["c"])("config",["groups"]),{icons:function(){return u["a"]}})},$=N,q=(a("b345"),a("0378")),_=a("27f9"),O=a("ddd8"),k=Object(b["a"])($,o,r,!1,null,null,null),j=k.exports;w()(k,"components",{QForm:q["a"],QInput:_["a"],QSelect:O["a"]});var S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card",{staticClass:"my-card"},[a("q-card-section",{staticClass:"row items-center q-pb-none"},[a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:e.icons.close,flat:"",round:"",dense:""}})],1),a("q-card-section",{staticClass:"column flex items-start justify-start"},[a("div",{staticClass:"column flex items-center justify-center q-pb-md",staticStyle:{width:"100%"}},[a("h5",{staticClass:"q-mb-md q-mt-none"},[e._v("\n        "+e._s(e.siteOwner)+" "+e._s(e.$t("digitalId.title"))+"\n      ")]),a("q-img",{staticClass:"qrcode",attrs:{src:e.qrcode}})],1),a("div",{staticClass:"row",staticStyle:{width:"100%"}},[a("div",{staticClass:"col-6"},[a("h6",{staticClass:"q-mb-none q-mt-sm"},[e._v("\n          "+e._s(e.$t("digitalId.fullName"))+"\n        ")]),a("div",{staticClass:"text-body1"},[e._v("\n          "+e._s(e.profile.fullName)+"\n        ")])]),a("div",{staticClass:"col-6"},[a("h6",{staticClass:"q-mb-none q-mt-sm"},[e._v("\n          "+e._s(e.$t("digitalId.memberState"))+"\n        ")]),a("div",{staticClass:"text-body1"},[e._v("\n          "+e._s(e.profile.memberStatus)+"\n        ")])])]),a("div",{staticClass:"row",staticStyle:{width:"100%"}},[a("div",{staticClass:"col-6"},[a("h6",{staticClass:"q-mb-none q-mt-sm"},[e._v("\n          "+e._s(e.$t("digitalId.memberId"))+"\n        ")]),a("div",{staticClass:"text-body1"},[e._v("\n          "+e._s(e.profile.id)+"\n        ")])]),a("div",{staticClass:"col-6"},[a("h6",{staticClass:"q-mb-none q-mt-sm"},[e._v("\n          "+e._s(e.$t("digitalId.memberSince"))+"\n        ")]),a("div",{staticClass:"text-body1"},[e._v("\n          "+e._s(e.profile.firstJoined)+"\n        ")])])])])],1)},I=[],E=a("967e"),Q=a.n(E),D=(a("96cf"),a("fa84")),B=a.n(D),L=a("d055"),F=a.n(L);function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){c()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var R={name:"DigitalIdCard",data:function(){return{qrcode:""}},mounted:function(){this.getIdToken()},methods:{getIdToken:function(){var e=this;this.$axios.get("api/profile/idtoken/").then((function(t){F.a.toDataURL(t.data.token,function(){var t=B()(Q.a.mark((function t(a,n){return Q.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.qrcode=n;case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())}))}},computed:M({},Object(l["c"])("config",["siteOwner"]),{},Object(l["c"])("profile",["profile"]),{icons:function(){return u["a"]}})},z=R,J=(a("181f"),a("f09f")),G=a("a370"),U=a("2c91"),A=a("9c40"),H=a("068f"),K=a("7f67"),V=Object(b["a"])(z,S,I,!1,null,"a9394b5e",null),W=V.exports;w()(V,"components",{QCard:J["a"],QCardSection:G["a"],QSpace:U["a"],QBtn:A["a"],QImg:H["a"]}),w()(V,"directives",{ClosePopup:K["a"]});var X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card",{staticClass:"login-card"},[a("h6",{staticClass:"q-ma-none q-pa-md"},[e._v("\n    "+e._s(e.$t("changePasswordCard.pageTitle"))+"\n  ")]),a("q-card-section",[a("q-form",{staticClass:"q-gutter-md",on:{submit:e.onSubmit}},[a("q-input",{attrs:{autofocus:"",filled:"",type:"password",label:"Current password","lazy-rules":"",rules:[function(t){return e.validatePassword(t)||e.$t("validation.invalidPassword")}]},model:{value:e.currentPassword,callback:function(t){e.currentPassword=t},expression:"currentPassword"}}),a("q-input",{attrs:{filled:"",type:"password",label:"New password","lazy-rules":"",rules:[function(t){return e.validatePassword(t)||e.$t("validation.invalidPassword")}]},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),a("q-input",{attrs:{filled:"",type:"password",label:"Confirm new password","lazy-rules":"",rules:[function(t){return e.validatePassword(t)||e.$t("validation.invalidPassword")},function(t){return e.validateMatchingField(t,e.newPassword)||e.$t("validation.passwordNotMatch")}]},model:{value:e.newPassword2,callback:function(t){e.newPassword2=t},expression:"newPassword2"}}),e.success?a("q-banner",{staticClass:"bg-positive text-white"},[e._v("\n        "+e._s(e.$t("changePasswordCard.success"))+"\n      ")]):e._e(),e.error?a("q-banner",{staticClass:"bg-negative text-white"},[e._v("\n        "+e._s(e.$t("changePasswordCard.fail"))+"\n      ")]):e._e(),a("div",{staticClass:"row"},[a("q-space"),e.success?e._e():a("q-btn",{attrs:{label:e.$t("button.submit"),type:"submit",color:"primary-btn",loading:e.buttonLoading}}),e.success?a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:e.$t("button.close"),flat:""}}):e._e()],1)],1)],1)],1)},Y=[],Z=(a("551c"),a("097d"),{name:"ChangePasswordCard",mixins:[d["a"]],data:function(){return{currentPassword:"",newPassword:"",newPassword2:"",buttonLoading:!1,error:!1,success:!1}},methods:{onSubmit:function(){this.changePassword()},changePassword:function(){var e=this;this.fail=!1,this.buttonLoading=!0,this.$axios.put("/api/profile/password/",{current:this.currentPassword,new:this.newPassword}).then((function(t){!0===t.data.success?(e.error=!1,e.success=!0):e.error=!0})).catch((function(t){throw e.error=!0,t})).finally((function(){e.buttonLoading=!1}))}}}),ee=Z,te=(a("137f"),a("54e1")),ae=Object(b["a"])(ee,X,Y,!1,null,"74e4df8a",null),ne=ae.exports;w()(ae,"components",{QCard:J["a"],QCardSection:G["a"],QForm:q["a"],QInput:_["a"],QBanner:te["a"],QSpace:U["a"],QBtn:A["a"]}),w()(ae,"directives",{ClosePopup:K["a"]});var se={name:"ProfilePage",components:{ChangePasswordCard:ne,DigitalIdCard:W,ProfileForm:j},data:function(){return{text:"",digitalId:!1,changePassword:!1}},computed:{icons:function(){return u["a"]}}},oe=se,re=a("9989"),ie=a("e7a9"),ce=a("24e8"),le=Object(b["a"])(oe,n,s,!1,null,null,null);t["default"]=le.exports;w()(le,"components",{QPage:re["a"],QBtnGroup:ie["a"],QBtn:A["a"],QDialog:ce["a"]})},"7e1e":function(e,t,a){},"97b7":function(e,t,a){"use strict";var n=a("c06f"),s=a.n(n);s.a},b345:function(e,t,a){"use strict";var n=a("7e1e"),s=a.n(n);s.a},c06f:function(e,t,a){},f0ae:function(e,t,a){}}]);
//# sourceMappingURL=4.js.map